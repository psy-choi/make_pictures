<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>기독교 짤 생성기</title>
    <link rel="icon" href="./image/pic.jpg">
    <meta name="og:image" content="./image/pic.jpg">
    <meta name="og:title" content="기독교 짤 생성">
    <meta name="og:description" content="기독교 짤 생성기">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-98733909-3"></script>
<script>
  // window.dataLayer = window.dataLayer || [];
  // function gtag(){dataLayer.push(argument);}
  // gtag('js', new Date());
  // gtag('config', 'UA-98733909-3');
</script>
<style>
@import url('https://fonts.googleapis.com/css2?family=East+Sea+Dokdo&display=swap');
*{
  max-width:100%; /*모바일에 맞추는 방*/
}
#caution {
  font-size: 10px;
}
.container {
  display: flex;
  justify-content: center;
  align-items: center;
}
footer {
  text-align: center;
}
.canvas {
  border:1px solid black;
  max-width: 100%;
  border-radius: 6px;
}
.textarea{
  display: flex;
  justify-content: center;
  align-items: center;
}
textarea{
  padding:0px 15px;
  max-width:610px;
  height:150px;
  resize: none;
}
.inner_setting{
  width:22%;
  float:left;
}
nav{
  width:640px;
  text-align: center;
  font-size:80px;
}
.form-group{
  text-align: center;
  width:640px;
  border-radius: 6px;
  background-color: #F0F0F0;
}
.btndownload, .btndownload:visited, .btndownload:link, .btndownload:active{
  display:inline-block;
  background-color:#5bc0de;
  color:#fff;
  border-radius: 6px;
  width: 200px;
  height: 30px;
  text-align: center;
  font-size:20px;
}


</style>
<script data-ad-client="ca-pub-5439665297289744" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<link rel="stylesheet" type="text/css" href="./style.css">
  </head>
  <body>
<header>
</header>
<main>
  <div class="container">
    <div class="row">
      <div class="col">
        <nav class='header'>
          <span class='title'><strong>기독교 짤 생성기</strong></span><br>
          <div id="caution">
            1) enter키를 누르시면 줄 바꿈이 됩니다.<br>
            2) 카카오톡 환경에서 저장이 되지 않을 수 있습니다. 크롬 혹은 사파리를 이용해주세요.
          </div>
        </nav>
        <canvas class="canvas" crossOrigin = 'Anonymous' id="mainCanvas" width="640" height="480"></canvas>
        <div class="form-group"><br>
          <label for="txtprey"><strong>기도하는 모습</strong></label>
          <div class="textarea">
          <textarea class="form-control" placeholder="기도제목을 적어주세요" id="txtprey"></textarea>
          </div><br>
          <div class="setting">


            <div id="font_size" class="inner_setting">
              폰트크기
            </div>
            <select class="inner_setting" id="txtfont1">
              <option value="40">40</option>
              <option value="30">30</option>
              <option value="20">20</option>
              <option value="10">10</option>
            </select>
            <div id="font_size" class="inner_setting">
              글꼴
            </div>
            <select class="inner_setting" id="txtshape1">
              <option value="East Sea Dokdo">East Sea Dokdo</option>
              <option value="Nanum Gothic">나눔고딕</option>
              <option value="Noto Sans KR">본고딕</option>
              <option value="Nanum Brush Script">나눔손글씨붓</option>
              <option value="궁서">궁서체</option>
              <option value="돋음">돋음체</option>
            </select>
          </div>
          <br><br>

          <a class="btndownload" id="btndownload"><strong>내려받기</strong></a><br><br>
        </div>


        <canvas class="canvas" crossOrigin = 'Anonymous' id="mainCanvas2" width="640" height="480"></canvas>
        <div class="form-group"><br>
          <label for="txtwith"><strong>예수님과 나</strong></label>
          <div class="textarea">
          <textarea class="form-control" placeholder="말씀을 적어주세요" id="txtwith"></textarea>
          </div><br>
          <div class="setting">

            <div id="font_size" class="inner_setting">
              폰트크기
            </div>
            <select class="inner_setting" id="txtfont2">
              <option value="40">40</option>
              <option value="30">30</option>
              <option value="20">20</option>
              <option value="10">10</option>
            </select>

            <div id="font_size" class="inner_setting">
              글꼴
            </div>
            <select class="inner_setting" id="txtshape2" value="40">
              <option value="East Sea Dokdo">East Sea Dokdo</option>
              <option value="Nanum Gothic">나눔고딕</option>
              <option value="Noto Sans KR">본고딕</option>
              <option value="Nanum Brush Script">나눔손글씨붓</option>
              <option value="궁서">궁서체</option>
              <option value="돋음">돋음체</option>
            </select>
          </div>
          <br><br>
          <a class="btndownload" id="btndownload2"><strong>내려받기</strong></a><br><br>
        </div>



      </div>
    </div>
  </div>
  <footer>
    <div>
      <strong>기독교 짤 생성기를 이용해주셔서 감사합니다.</strong><br>
      made by "psy_choi"
    </div>
  </footer>
</main>
<script crossOrigin = 'Anonymous'>
  const beforePositionArr = []
  const preyImg = new Image();
  const withImg = new Image();
  const mainCanvas = document.getElementById('mainCanvas'); //mainCanvas에 대한 요소를 가져
  const mainCanvas2 = document.getElementById('mainCanvas2');


  const drawStroked = function (ctx, text, x, y, size){ // 이 xy 값에 text를 놓
    const arr = text.split("\n");
    var interval = 55;
    if (size === 40) {
      interval = 55;
    }else if (size === 30) {
      interval = 45;
    }else if (size === 20) {
      interval = 35;
    }else if (size === 10) {
      interval = 25;
    }
    for(var i = 0; i < arr.length; i++){
      var k = interval * i;
      ctx.textAlign = "center"
      ctx.strokeStyle = '#222';
      ctx.lineWidth = 2;
      ctx.fillStyle = 'black'
      ctx.fillText(arr[i], x, y+k);
    }
  };


  //밑은 제이 쿼리 코드임
  $(function(){
    const $txtprey = $('#txtprey'); //$ 안에 #을 넣어서 id값을 드러낸다.
    const $txtwith = $('#txtwith');
    const $font_size1 = $('#txtfont1');
    const $font_size2 = $('#txtfont2');
    const $font_shape1 = $('#txtshape1');
    const $font_shape2 = $('#txtshape2');


    $txtprey.keyup(function(){
      var prey = $(this).val();
      var font_size1 = $font_size1.val();
      var font_shape1 = $font_shape1.val();
      const ctx1 = mainCanvas.getContext("2d"); //canvas에서 2d 값으로 얻고 싶다면 이렇게 함
      ctx1.drawImage(preyImg, 0, 0);
      ctx1.font = `${font_size1}pt '${font_shape1}'`;
      drawStroked(ctx1, prey, 440, 100, font_size1);
    });
    $txtwith.keyup(function(){
      var withw = $(this).val();
      var font_size2 = $font_size2.val();
      var font_shape2 = $font_shape2.val();
      const ctx2 = mainCanvas2.getContext("2d"); //canvas에서 2d 값으로 얻고 싶다면 이렇게 함
      ctx2.drawImage(withImg, 0, 0);
      ctx2.font = `${font_size2}pt`+ `'${font_shape2}'`;
      drawStroked(ctx2, withw, 320, 80);
    });
    $('#btndownload').click(function(){
      const href = mainCanvas.toDataURL(); //url을 가져오는 방식
      this.href = href;
      this.download ="prey.png";
    });
    $('#btndownload2').click(function(){
      const href = mainCanvas2.toDataURL(); //url을 가져오는 방식
      this.href = href;
      this.download ="with.png";
    });

    window.onload = function(){
      const ctx1 = mainCanvas.getContext("2d");
      const ctx2 = mainCanvas2.getContext("2d");
      ctx1.fillStyle = "white";
      ctx1.scale(1,1);
      preyImg.onload = function (){
        ctx1.drawImage(preyImg, 0, 0);
        $txtprey.keyup();
      };
      preyImg.src = "./image/기도.jpg";
      preyImg.crossOrigin = 'Anonymous';


      withImg.onload = function() {
        ctx2.drawImage(withImg, 0, 0);
        $txtprey.keyup();
      };
      withImg.src = "./image/함께하는.jpg";
      withImg.crossOrigin = 'Anonymous';

    };
  });
</script>

<script>
  // $(function(){
  //   $('#btndownload').click(function(){
  //     const v= JSON.stringify({prey:$('#txtprey').val(), with:$('#txtwith').val()});
  //     gtag('event', 'christian', {event_category:'download', 'event_label':v});
  //     });
  //   });
  </script>
  </body>
</html>
